# 10 NumPy 位运算

NumPy **"bitwise_"** 开头的函数是位运算函数，NumPy 中提供了以下按位运算函数：

| 序号 | 函数        | 位运算符 | 描述说明                         |
| ---- | ----------- | -------- | -------------------------------- |
| 1    | bitwise_and | &        | 计算数组元素之间的按位与运算。   |
| 2    | bitwise_or  | \|       | 计算数组元素之间的按位或运算。   |
| 3    | invert      | ~        | 计算数组元素之间的按位取反运算。 |
| 4    | left_shift  | <<       | 将二进制数的位数向左移。         |
| 5    | right_shift | >>       | 将二进制数的位数向右移。         |

## bitwise_and()

该函数对数组中整数的二进制数进行“按位与”运算。示例如下：

```python
import numpy as np 
a = 10 
b = 12 
#a的二进制数
print(bin(a))
#b的二进制数
print(bin(b)) 
#将a与b执行按位与操作
c = np.bitwise_and(a,b)
print(bin(c))
print(c) 
```

输出结果如下：

```
0b1010
0b1100
0b1000
8
```

如果两个的二进制数相对应的位都为 1，那么执行位与运算后，该位的结果就为 1，否则就为 0。上述示例：a 与 b 位与运算的结果为 1000，因此它的十进制结果为 8。

位与运算的真值表，如下所示：

| A    | B    | AND(A,B) |
| ---- | ---- | -------- |
| 0    | 0    | 0        |
| 0    | 1    | 0        |
| 1    | 0    | 0        |
| 1    | 1    | 1        |

## bitwise_or()

bitwise_or() 对数组中整数的二进制数执行“按位或”运算。示例如下：

```python
import numpy as np
a,b = 13,17
#13 和 17 的二进制数
print (bin(a), bin(b))
#13 和 17 的位或
c = np.bitwise_or(13, 17)
print(bin(c))
print(c) 
```

输出结果：

```
0b1101 
0b10001
0b11101
29
```

对于按位或运算，只要相对应的二进制位上有一个为 1，那么它的运算结果就位 1，否则为 0，其真值表如下：

| A    | B    | OR(A,B) |
| ---- | ---- | ------- |
| 0    | 0    | 0       |
| 0    | 1    | 1       |
| 1    | 0    | 1       |
| 1    | 1    | 1       |

## invert()

invert() 函数对数组中整数进行位取反运算，也就是 0 变成 1，1 变为 0。若是有符号的负整数，取其二进制数的补码，并执行 +1 操作。对于有符号二进制数，其最高位为 0， 表示正数；最高位为 1， 表示负数。

看看 ~1 的计算步骤：

- 将**`1`**(这里叫：原码)转二进制 ＝ **`00000001`**

- 按位取反 ＝ **`11111110`**

- 发现符号位(即最高位)为**`1`**(表示负数)，将除符号位之外的其他数字取反 ＝ **`10000001`**

- 末位加1取其补码 ＝ **`10000010`**

- 转换回十进制 ＝ **`-2`**

- | 表达式 | 二进制值（2 的补数）                | 十进制值 |
  | :----- | :---------------------------------- | :------- |
  | 5      | 00000000 00000000 00000000 0000010  | 5        |
  | ~5     | 11111111 11111111 11111111 11111010 | -6       |

下面通过一组示例，对取反运算进行说明：

```python
import numpy as np 
#数据类型为无符号整型uint8
arr = np.array([20],dtype = np.uint8) 
print(arr)
#二进制表示，8表示显示位数
print(np.binary_repr(20,8)) 
print(np.invert(arr)) 
#进行取反操作
print(np.binary_repr(235,8))  
```

输出结果如下：

```
[20]
00010100
[235]
11101011
```

## left_shift()

该方法把数组元素的二进制数向左移动到指定位置，而其返回值所对应的二进制数，则会从右侧追加相等数量的 0（移动了多少位便追加多少个0）。

示例如下：

```python
import numpy as np
#将 10 左移两位
print (np.left_shift(10,2))
#10 的二进制表示
print (np.binary_repr(10, width = 8))
#40 的二进制表示
print (np.binary_repr(40, width = 8))
```

输出结果为：

```
40
00001010
00101000
```

## right_shift()

right_shift() 将数组中元素的二进制数向右移动到指定位置，其返回值对应的二进制数会从左侧追加相等数量的 0。该函数使用与 left_shift() 恰好相反。

示例如下：

```python
import numpy as np 
#将 40 右移两位
print (np.right_shift(40,2))
#40 的二进制表示
print (np.binary_repr(40, width = 8))
#10 的二进制表示
print (np.binary_repr(10, width = 8))
```

输出结果为：

```
10
00101000
00001010
```

